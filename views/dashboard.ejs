<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/css/index.css">
    <script src="/js/theme-control/theme-control.js" defer></script>
    <link rel="stylesheet" href="/css/darktheme.css">
    <script src="/js/animations/index-animation.js"></script>
    <link rel="stylesheet" href="/css/animation-index.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="icon" type="image/x-icon" href="/img/favicon.png">
    <script src="/js/base/scroll.js" defer></script>
    <script src="/js/base/dashboard.js" defer></script>
</head>
<body>
<nav>
    <div class="row">
        <img src="../img/logo_small.png"
             alt="SAS Virtual Logo" id="logo">
        <div class="burger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/dashboard/profile">Profile</a></li>
        <li><a href="/dashboard/flights">Flights</a></li>
        <li><a href="/logout">Logout</a></li>
        <li>
            <img id="theme-icon" src="/img/dark-theme.svg" alt="">
        </li>
    </ul>
</nav>
<button id="postButton" >Post</button>
<form id="postForm" action="/post" method="post" enctype="multipart/form-data">
    <input type="text" name="title">
    <input type="text" name="content">
    <input type="file" name="image">
    <input type="submit">
</form>
<% for (item of posts) { %>
    <div class="post">
        <h1><%= item.title %></h1>
        <p><%= item.content %></p>
        <p><%= new Date(item.created_at).toLocaleDateString() %></p>
        <img src="/uploads/<%= item.image_url %>" alt="">

        <form action="/comment" method="post">
            <input type="hidden" name="post_id" value="<%= item.id %>">
            <input type="text" name="comment">
            <input type="submit" value="Comment on post">
        </form>

        <p>Comments:</p>
        <% for (comment of (item.comments ? JSON.parse("[" + item.comments + "]") : []) ) { %>
            <p>
                <strong><%= comment.user.username %></strong>
                <span><%= new Date(comment.created_at).toLocaleDateString() %></span>
            </p>
            <p><%= comment.message %></p>
            <% if (comment.user.id == user.id) { %>
                <form action="/dashboard/comments/delete" method="post">
                    <input type="hidden" name="id" value="<%= comment.id %>">
                    <input type="submit" value="Delete Comment">
                </form>
            <% } %>
        <% } %>
    </div>
<% } %>
</body>
</html>